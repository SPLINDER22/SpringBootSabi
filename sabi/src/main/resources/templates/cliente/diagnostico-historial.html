<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Historial de Diagn√≥sticos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/diagnostico-historial.css}">
    <style>
        .comparativa-box {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 3px solid #7dd3fc;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(56, 189, 248, 0.15);
        }
        .metric-comparison {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 15px;
            align-items: center;
            margin: 15px 0;
        }
        .metric-value {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            background: white;
            font-weight: 700;
            font-size: 1.1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .metric-change {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .metric-change.positive {
            color: #f87171;
        }
        .metric-change.negative {
            color: #10b981;
        }
        .metric-change.neutral {
            color: #6b7280;
        }
        @media (max-width: 768px) {
            .metric-comparison {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }
    </style>
</head>
<body th:replace="layout/layout :: layout('Historial de Diagn√≥sticos', ~{::section})">
<section th:fragment="section">
<div class="container py-4">
    <div class="historial-card">
        <h2 class="mb-2"><i class="fas fa-history"></i> Historial de Diagn√≥sticos</h2>
        <p class="mb-0">Total de diagn√≥sticos: <strong th:text="${historial != null ? historial.size() : 0}">0</strong></p>
    </div>

    <!-- Alerta si no hay diagn√≥sticos -->
    <div th:if="${historial == null || historial.isEmpty()}" class="alert alert-info mt-4">
        <h5><i class="fas fa-info-circle"></i> No tienes diagn√≥sticos registrados</h5>
        <p class="mb-2">Crea tu primer diagn√≥stico para comenzar a hacer seguimiento de tu progreso.</p>
        <a href="/diagnostico/cliente" class="btn btn-primary">
            <i class="fas fa-plus-circle"></i> Crear Mi Primer Diagn√≥stico
        </a>
    </div>

    <!-- Contenido del historial (solo si hay diagn√≥sticos) -->
    <div th:if="${historial != null && !historial.isEmpty()}">
        <!-- Comparativa R√°pida (si hay m√°s de un diagn√≥stico) -->
    <div class="comparativa-box" th:if="${tieneComparativa}">
        <h4 class="mb-3"><i class="fas fa-chart-bar"></i> üìä Tu Evoluci√≥n Reciente</h4>
        <p class="text-muted mb-4">Comparaci√≥n entre tu diagn√≥stico m√°s reciente y el anterior</p>

        <div class="row">
            <!-- Comparaci√≥n de Peso -->
            <div class="col-md-4" th:with="pesoActual=${diagnosticoActual.peso}, pesoAnterior=${diagnosticoAnterior.peso}">
                <h6 class="mb-3">‚öñÔ∏è Peso</h6>
                <div class="metric-comparison" th:if="${pesoActual != null && pesoAnterior != null}">
                    <div class="metric-value">
                        <small class="text-muted">Anterior</small><br>
                        <span th:text="${#numbers.formatDecimal(pesoAnterior, 1, 1) + ' kg'}"></span>
                    </div>
                    <div class="metric-change" th:with="diferencia=${pesoActual - pesoAnterior}"
                         th:classappend="${diferencia > 0} ? 'positive' : (${diferencia < 0} ? 'negative' : 'neutral')">
                        <span th:if="${diferencia > 0}">‚ÜóÔ∏è +<span th:text="${#numbers.formatDecimal(diferencia, 1, 1)}"></span></span>
                        <span th:if="${diferencia < 0}">‚ÜòÔ∏è <span th:text="${#numbers.formatDecimal(diferencia, 1, 1)}"></span></span>
                        <span th:if="${diferencia == 0}">‚û°Ô∏è</span>
                    </div>
                    <div class="metric-value">
                        <small class="text-muted">Actual</small><br>
                        <span th:text="${#numbers.formatDecimal(pesoActual, 1, 1) + ' kg'}"></span>
                    </div>
                </div>
                <div class="text-center mt-2">
                    <span th:if="${pesoActual > pesoAnterior}" class="badge bg-danger">Subi√≥ de peso</span>
                    <span th:if="${pesoActual < pesoAnterior}" class="badge bg-success">Baj√≥ de peso</span>
                    <span th:if="${pesoActual == pesoAnterior}" class="badge bg-secondary">Sin cambio</span>
                </div>
            </div>

            <!-- Comparaci√≥n de IMC -->
            <div class="col-md-4" th:with="imcActual=${diagnosticoActual.peso != null && diagnosticoActual.estatura != null ? T(java.lang.Math).round((diagnosticoActual.peso / ((diagnosticoActual.estatura/100)*(diagnosticoActual.estatura/100))) * 10) / 10.0 : null}, imcAnterior=${diagnosticoAnterior.peso != null && diagnosticoAnterior.estatura != null ? T(java.lang.Math).round((diagnosticoAnterior.peso / ((diagnosticoAnterior.estatura/100)*(diagnosticoAnterior.estatura/100))) * 10) / 10.0 : null}">
                <h6 class="mb-3">üìä IMC</h6>
                <div class="metric-comparison" th:if="${imcActual != null && imcAnterior != null}">
                    <div class="metric-value">
                        <small class="text-muted">Anterior</small><br>
                        <span th:text="${#numbers.formatDecimal(imcAnterior, 1, 1)}"></span>
                    </div>
                    <div class="metric-change" th:with="diferencia=${imcActual - imcAnterior}"
                         th:classappend="${diferencia > 0} ? 'positive' : (${diferencia < 0} ? 'negative' : 'neutral')">
                        <span th:if="${diferencia > 0}">‚ÜóÔ∏è +<span th:text="${#numbers.formatDecimal(diferencia, 1, 1)}"></span></span>
                        <span th:if="${diferencia < 0}">‚ÜòÔ∏è <span th:text="${#numbers.formatDecimal(diferencia, 1, 1)}"></span></span>
                        <span th:if="${diferencia == 0}">‚û°Ô∏è</span>
                    </div>
                    <div class="metric-value">
                        <small class="text-muted">Actual</small><br>
                        <span th:text="${#numbers.formatDecimal(imcActual, 1, 1)}"></span>
                    </div>
                </div>
            </div>

            <!-- Comparaci√≥n de Grasa Corporal -->
            <div class="col-md-4" th:if="${diagnosticoActual.porcentajeGrasaCorporal != null && diagnosticoAnterior.porcentajeGrasaCorporal != null}" th:with="grasaActual=${diagnosticoActual.porcentajeGrasaCorporal}, grasaAnterior=${diagnosticoAnterior.porcentajeGrasaCorporal}">
                <h6 class="mb-3">üí™ % Grasa Corporal</h6>
                <div class="metric-comparison">
                    <div class="metric-value">
                        <small class="text-muted">Anterior</small><br>
                        <span th:text="${#numbers.formatDecimal(grasaAnterior, 1, 1) + '%'}"></span>
                    </div>
                    <div class="metric-change" th:with="diferencia=${grasaActual - grasaAnterior}"
                         th:classappend="${diferencia < 0} ? 'negative' : (${diferencia > 0} ? 'positive' : 'neutral')">
                        <span th:if="${diferencia > 0}">‚ÜóÔ∏è +<span th:text="${#numbers.formatDecimal(diferencia, 1, 1)}"></span></span>
                        <span th:if="${diferencia < 0}">‚ÜòÔ∏è <span th:text="${#numbers.formatDecimal(diferencia, 1, 1)}"></span></span>
                        <span th:if="${diferencia == 0}">‚û°Ô∏è</span>
                    </div>
                    <div class="metric-value">
                        <small class="text-muted">Actual</small><br>
                        <span th:text="${#numbers.formatDecimal(grasaActual, 1, 1) + '%'}"></span>
                    </div>
                </div>
                <div class="text-center mt-2">
                    <span th:if="${grasaActual < grasaAnterior}" class="badge bg-success">Redujo grasa</span>
                    <span th:if="${grasaActual > grasaAnterior}" class="badge bg-danger">Aument√≥ grasa</span>
                    <span th:if="${grasaActual == grasaAnterior}" class="badge bg-secondary">Sin cambio</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Mensaje cuando solo hay 1 diagn√≥stico -->
    <div th:if="${historial != null && historial.size() == 1}" class="alert alert-info mt-4" style="background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); border: 3px solid #ff9800; border-radius: 15px;">
        <div class="d-flex align-items-center">
            <i class="fas fa-chart-line fa-3x me-3" style="color: #f57c00;"></i>
            <div>
                <h5 class="mb-2" style="color: #e65100;">
                    <i class="fas fa-star"></i> ¬°Tienes tu primer diagn√≥stico!
                </h5>
                <p class="mb-2" style="color: #ef6c00; font-size: 1.1rem;">
                    <strong>Para ver la comparativa de evoluci√≥n</strong>, necesitas crear un nuevo diagn√≥stico.
                </p>
                <p class="mb-0" style="color: #f57c00;">
                    La comparativa te mostrar√° si has <strong>subido o bajado de peso</strong>, cambios en tu <strong>IMC</strong> y <strong>grasa corporal</strong>.
                </p>
            </div>
        </div>
    </div>

    <!-- Tabla de Diagn√≥sticos -->
    <table class="table historial-table table-bordered table-hover">
        <thead>
            <tr>
                <th>#</th>
                <th>Fecha</th>
                <th>Peso</th>
                <th>Estatura</th>
                <th>IMC</th>
                <th>Nivel</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="diag, stat : ${historial}">
                <td>
                    <span th:text="${historial.size() - stat.index}"></span>
                    <span th:if="${stat.first}" class="badge bg-success ms-1">Actual</span>
                </td>
                <td th:text="${#temporals.format(diag.fecha, 'dd/MM/yyyy')}"></td>
                <td th:text="${diag.peso != null ? diag.peso + ' kg' : 'N/A'}"></td>
                <td th:text="${diag.estatura != null ? diag.estatura + ' cm' : 'N/A'}"></td>
                <td th:with="imc=${diag.peso != null && diag.estatura != null ? T(java.lang.Math).round((diag.peso / ((diag.estatura/100)*(diag.estatura/100))) * 10) / 10.0 : null}">
                    <span th:text="${imc != null ? #numbers.formatDecimal(imc, 1, 1) : 'N/A'}"></span>
                </td>
                <td th:text="${diag.nivelExperiencia}"></td>
                <td>
                    <button type="button" class="btn btn-info btn-sm" data-bs-toggle="modal" data-bs-target="#modalDetalle" th:attr="data-id=${diag.idDiagnostico}">
                        <i class="fas fa-eye"></i> Ver detalle
                    </button>
                    <a th:href="@{/cliente/diagnostico/descargar/{id}(id=${diag.idDiagnostico})}" class="btn btn-success btn-sm">
                        <i class="fas fa-file-excel"></i> Descargar
                    </a>
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Modal para detalle de diagn√≥stico -->
    <div class="modal fade" id="modalDetalle" tabindex="-1" aria-labelledby="modalDetalleLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="modalDetalleLabel">
                        <i class="fas fa-file-medical"></i> Detalle de Diagn√≥stico
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <div id="detalleDiagnosticoContent">
                        <div class="text-center">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Cargando...</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times"></i> Cerrar
                    </button>
                </div>
            </div>
        </div>
    </div>
    </div> <!-- Fin del div th:if historial no vac√≠o -->

    <!-- Botones de navegaci√≥n -->
    <div class="mt-4">
        <a href="/cliente/dashboard" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Volver al Dashboard
        </a>
        <a href="/diagnostico/cliente" class="btn btn-primary" th:if="${historial != null && !historial.isEmpty()}">
            <i class="fas fa-plus-circle"></i> Nuevo Diagn√≥stico
        </a>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var modal = document.getElementById('modalDetalle');
        var diagId = null;

        document.querySelectorAll('button[data-bs-target="#modalDetalle"]').forEach(function(btn) {
            btn.addEventListener('click', function() {
                diagId = btn.getAttribute('data-id');
            });
        });

        modal.addEventListener('shown.bs.modal', function () {
            if (!diagId) return;

            fetch('/diagnostico/detalle/' + diagId)
                .then(response => response.json())
                .then(data => {
                    const imc = data.peso && data.estatura ?
                        (Math.round((data.peso / Math.pow(data.estatura/100, 2)) * 10) / 10) : null;

                    let imcCategoria = '';
                    let imcColor = '';
                    if (imc) {
                        if (imc < 18.5) {
                            imcCategoria = 'Bajo peso';
                            imcColor = 'info';
                        } else if (imc < 25) {
                            imcCategoria = 'Normal';
                            imcColor = 'success';
                        } else if (imc < 30) {
                            imcCategoria = 'Sobrepeso';
                            imcColor = 'warning';
                        } else {
                            imcCategoria = 'Obesidad';
                            imcColor = 'danger';
                        }
                    }

                    document.getElementById('detalleDiagnosticoContent').innerHTML = `
                        <!-- ========================================
                             üìã DISE√ëO MEJORADO Y BALANCEADO
                             ======================================== -->

                        <!-- Objetivo Destacado -->
                        ${data.objetivo ? `
                            <div class="alert mb-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                                          border: none; color: white; border-radius: 15px;
                                                          box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);">
                                <div class="d-flex align-items-center">
                                    <div style="font-size: 3rem; margin-right: 20px;">üéØ</div>
                                    <div style="flex: 1;">
                                        <h5 style="margin: 0; font-weight: bold; color: white;">
                                            Mi Objetivo en ese momento
                                        </h5>
                                        <p style="margin: 5px 0 0 0; font-size: 1.2rem; font-weight: 600;">
                                            "${data.objetivo}"
                                        </p>
                                    </div>
                                </div>
                            </div>
                        ` : ''}

                        <!-- M√©tricas Principales en Cards Destacadas -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-3 col-6">
                                <div class="card text-center" style="border: 2px solid #3b82f6; border-radius: 15px; background: linear-gradient(135deg, #dbeafe 0%, #eff6ff 100%);">
                                    <div class="card-body">
                                        <div style="font-size: 2rem;">‚öñÔ∏è</div>
                                        <h6 class="card-title mb-1" style="color: #1e40af; font-weight: bold;">Peso</h6>
                                        <h3 class="mb-0" style="color: #2563eb; font-weight: 800;">${data.peso} <small>kg</small></h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6">
                                <div class="card text-center" style="border: 2px solid #10b981; border-radius: 15px; background: linear-gradient(135deg, #d1fae5 0%, #ecfdf5 100%);">
                                    <div class="card-body">
                                        <div style="font-size: 2rem;">üìè</div>
                                        <h6 class="card-title mb-1" style="color: #065f46; font-weight: bold;">Estatura</h6>
                                        <h3 class="mb-0" style="color: #059669; font-weight: 800;">${data.estatura} <small>cm</small></h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6">
                                <div class="card text-center" style="border: 2px solid #8b5cf6; border-radius: 15px; background: linear-gradient(135deg, #ede9fe 0%, #f5f3ff 100%);">
                                    <div class="card-body">
                                        <div style="font-size: 2rem;">üìä</div>
                                        <h6 class="card-title mb-1" style="color: #5b21b6; font-weight: bold;">IMC</h6>
                                        <h3 class="mb-0" style="color: #7c3aed; font-weight: 800;">${imc || 'N/A'}</h3>
                                        ${imc ? '<span class="badge bg-' + imcColor + ' mt-1">' + imcCategoria + '</span>' : ''}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6">
                                <div class="card text-center" style="border: 2px solid #f59e0b; border-radius: 15px; background: linear-gradient(135deg, #fef3c7 0%, #fffbeb 100%);">
                                    <div class="card-body">
                                        <div style="font-size: 2rem;">üí™</div>
                                        <h6 class="card-title mb-1" style="color: #92400e; font-weight: bold;">% Grasa</h6>
                                        <h3 class="mb-0" style="color: #d97706; font-weight: 800;">${data.porcentajeGrasaCorporal || 'N/A'}${data.porcentajeGrasaCorporal ? '<small>%</small>' : ''}</h3>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Grid de Informaci√≥n Organizada -->
                        <div class="row g-4">
                            <!-- Columna 1: Informaci√≥n B√°sica y Disponibilidad -->
                            <div class="col-md-4">
                                <div class="card mb-3" style="border-radius: 12px; border-left: 4px solid #3b82f6;">
                                    <div class="card-header" style="background: #eff6ff; border-bottom: 2px solid #dbeafe;">
                                        <h6 class="mb-0" style="color: #1e40af; font-weight: bold;">
                                            <i class="fas fa-info-circle"></i> Informaci√≥n B√°sica
                                        </h6>
                                    </div>
                                    <div class="card-body p-3">
                                        <div class="mb-2">
                                            <small class="text-muted d-block">üìÖ Fecha del diagn√≥stico</small>
                                            <strong>${data.fecha}</strong>
                                        </div>
                                        <hr class="my-2">
                                        <div class="mb-2">
                                            <small class="text-muted d-block">üéØ Nivel de experiencia</small>
                                            <strong>${data.nivelExperiencia}</strong>
                                        </div>
                                        <hr class="my-2">
                                        <div class="mb-2">
                                            <small class="text-muted d-block">‚è∞ Disponibilidad de tiempo</small>
                                            <strong>${data.disponibilidadTiempo || 'N/A'}</strong>
                                        </div>
                                        <hr class="my-2">
                                        <div class="mb-0">
                                            <small class="text-muted d-block">üèãÔ∏è Acceso a recursos</small>
                                            <strong>${data.accesoRecursos || 'N/A'}</strong>
                                        </div>
                                    </div>
                                </div>

                                <div class="card" style="border-radius: 12px; border-left: 4px solid #ef4444;">
                                    <div class="card-header" style="background: #fef2f2; border-bottom: 2px solid #fecaca;">
                                        <h6 class="mb-0" style="color: #991b1b; font-weight: bold;">
                                            <i class="fas fa-heartbeat"></i> Salud
                                        </h6>
                                    </div>
                                    <div class="card-body p-3">
                                        <div class="mb-2">
                                            <small class="text-muted d-block">‚ù§Ô∏è Frecuencia card√≠aca</small>
                                            <strong>${data.frecuenciaCardiacaReposo || 'N/A'} ${data.frecuenciaCardiacaReposo ? 'bpm' : ''}</strong>
                                        </div>
                                        <hr class="my-2">
                                        <div class="mb-2">
                                            <small class="text-muted d-block">ü©∫ Presi√≥n arterial</small>
                                            <strong>${data.presionArterial || 'N/A'}</strong>
                                        </div>
                                        <hr class="my-2">
                                        <div class="mb-2">
                                            <small class="text-muted d-block">ü§ï Lesiones</small>
                                            <strong>${data.lesiones || 'Ninguna'}</strong>
                                        </div>
                                        <hr class="my-2">
                                        <div class="mb-0">
                                            <small class="text-muted d-block">üè• Condiciones m√©dicas</small>
                                            <strong>${data.condicionesMedicas || 'Ninguna'}</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Columna 2: Medidas Corporales y H√°bitos -->
                            <div class="col-md-4">
                                <div class="card mb-3" style="border-radius: 12px; border-left: 4px solid #8b5cf6;">
                                    <div class="card-header" style="background: #f5f3ff; border-bottom: 2px solid #ede9fe;">
                                        <h6 class="mb-0" style="color: #5b21b6; font-weight: bold;">
                                            <i class="fas fa-ruler-combined"></i> Medidas Corporales
                                        </h6>
                                    </div>
                                    <div class="card-body p-3">
                                        <div class="mb-2">
                                            <small class="text-muted d-block">üìê Circunferencia de cintura</small>
                                            <strong>${data.circunferenciaCintura || 'N/A'} ${data.circunferenciaCintura ? 'cm' : ''}</strong>
                                        </div>
                                        <hr class="my-2">
                                        <div class="mb-2">
                                            <small class="text-muted d-block">üìê Circunferencia de cadera</small>
                                            <strong>${data.circunferenciaCadera || 'N/A'} ${data.circunferenciaCadera ? 'cm' : ''}</strong>
                                        </div>
                                        <hr class="my-2">
                                        <div class="mb-2">
                                            <small class="text-muted d-block">üí™ Circunferencia de brazo</small>
                                            <strong>${data.circunferenciaBrazo || 'N/A'} ${data.circunferenciaBrazo ? 'cm' : ''}</strong>
                                        </div>
                                        <hr class="my-2">
                                        <div class="mb-0">
                                            <small class="text-muted d-block">ü¶µ Circunferencia de pierna</small>
                                            <strong>${data.circunferenciaPierna || 'N/A'} ${data.circunferenciaPierna ? 'cm' : ''}</strong>
                                        </div>
                                    </div>
                                </div>

                                <div class="card" style="border-radius: 12px; border-left: 4px solid #10b981;">
                                    <div class="card-header" style="background: #ecfdf5; border-bottom: 2px solid #d1fae5;">
                                        <h6 class="mb-0" style="color: #065f46; font-weight: bold;">
                                            <i class="fas fa-utensils"></i> H√°bitos de Vida
                                        </h6>
                                    </div>
                                    <div class="card-body p-3">
                                        <div class="mb-2">
                                            <small class="text-muted d-block">üò¥ Horas de sue√±o</small>
                                            <strong>${data.horasSueno || 'N/A'} ${data.horasSueno ? 'horas' : ''}</strong>
                                        </div>
                                        <hr class="my-2">
                                        <div class="mb-0">
                                            <small class="text-muted d-block">üçé H√°bitos alimenticios</small>
                                            <strong>${data.habitosAlimenticios || 'N/A'}</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Columna 3: Fotos del Diagn√≥stico -->
                            <div class="col-md-4">
                                <div class="card" style="border-radius: 12px; border-left: 4px solid #f59e0b;">
                                    <div class="card-header" style="background: #fffbeb; border-bottom: 2px solid #fef3c7;">
                                        <h6 class="mb-0" style="color: #92400e; font-weight: bold;">
                                            <i class="fas fa-images"></i> Fotos del Diagn√≥stico
                                        </h6>
                                    </div>
                                    <div class="card-body p-3">
                                        ${data.fotoFrontalUrl || data.fotoLateralUrl || data.fotoTraseraUrl ? `
                                            <div class="row g-2">
                                                ${data.fotoFrontalUrl ? `
                                                    <div class="col-12 mb-3">
                                                        <div class="card border-0 shadow-sm">
                                                            <img src="${data.fotoFrontalUrl}" class="card-img-top" alt="Frontal"
                                                                 style="height: 180px; object-fit: cover; border-radius: 8px 8px 0 0;">
                                                            <div class="card-footer text-center bg-light border-0" style="border-radius: 0 0 8px 8px;">
                                                                <small style="font-weight: 600; color: #6b7280;">üì∏ Foto Frontal</small>
                                                            </div>
                                                        </div>
                                                    </div>
                                                ` : ''}
                                                ${data.fotoLateralUrl ? `
                                                    <div class="col-12 mb-3">
                                                        <div class="card border-0 shadow-sm">
                                                            <img src="${data.fotoLateralUrl}" class="card-img-top" alt="Lateral"
                                                                 style="height: 180px; object-fit: cover; border-radius: 8px 8px 0 0;">
                                                            <div class="card-footer text-center bg-light border-0" style="border-radius: 0 0 8px 8px;">
                                                                <small style="font-weight: 600; color: #6b7280;">üì∏ Foto Lateral</small>
                                                            </div>
                                                        </div>
                                                    </div>
                                                ` : ''}
                                                ${data.fotoTraseraUrl ? `
                                                    <div class="col-12 mb-3">
                                                        <div class="card border-0 shadow-sm">
                                                            <img src="${data.fotoTraseraUrl}" class="card-img-top" alt="Trasera"
                                                                 style="height: 180px; object-fit: cover; border-radius: 8px 8px 0 0;">
                                                            <div class="card-footer text-center bg-light border-0" style="border-radius: 0 0 8px 8px;">
                                                                <small style="font-weight: 600; color: #6b7280;">üì∏ Foto Trasera</small>
                                                            </div>
                                                        </div>
                                                    </div>
                                                ` : ''}
                                            </div>
                                        ` : `
                                            <div class="text-center py-5" style="color: #9ca3af;">
                                                <i class="fas fa-image fa-3x mb-3"></i>
                                                <p class="mb-0">No hay fotos disponibles para este diagn√≥stico</p>
                                            </div>
                                        `}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Nota Informativa -->
                        <div class="alert mt-4 mb-0" style="background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%);
                                                           border-left: 4px solid #0ea5e9; border-radius: 10px;">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-info-circle fa-2x me-3" style="color: #0284c7;"></i>
                                <div>
                                    <strong style="color: #075985;">Nota:</strong>
                                    <span style="color: #0c4a6e;">
                                        Los datos mostrados son solo informativos y corresponden a este diagn√≥stico espec√≠fico.
                                        No pueden ser editados desde aqu√≠.
                                    </span>
                                </div>
                            </div>
                        </div>
                    `;
                })
                .catch(error => {
                    document.getElementById('detalleDiagnosticoContent').innerHTML = `
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle"></i> Error al cargar los datos del diagn√≥stico.
                        </div>
                    `;
                });
        });
    });
</script>
</section>
</body>
</html>
