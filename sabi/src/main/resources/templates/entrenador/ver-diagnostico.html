<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ver Diagnostico Completo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/diagnostico-form.css}">
    <style>
        .cliente-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .cliente-foto {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 5px solid white;
            object-fit: cover;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .fotos-diagnostico {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .foto-item {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .foto-item img {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }
        .foto-label {
            background: #f8f9fa;
            padding: 10px;
            text-align: center;
            font-weight: 600;
            color: #495057;
        }
        .categoria {
            margin-bottom: 25px;
        }
        .imc-badge {
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            display: inline-block;
            margin: 10px 0;
        }
        .info-row {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        .info-label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 5px;
        }
        .info-value {
            color: #212529;
        }
        .objetivo-box {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #f39c12;
            margin: 20px 0;
        }
        .descripcion-box {
            background: linear-gradient(135deg, #a8e6cf 0%, #dcedc1 100%);
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #27ae60;
            margin: 20px 0;
        }
        @media (max-width: 768px) {
            .cliente-header {
                text-align: center;
            }
            .fotos-diagnostico {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body th:replace="layout/layout :: layout('Ver Diagnostico Completo', ~{::section})">
<section th:fragment="section">
<div class="container-fluid py-4">
    <div th:if="${error != null}" class="alert alert-danger" role="alert">
        <i class="fa-solid fa-triangle-exclamation me-2"></i>
        <span th:text="${error}"></span>
    </div>

    <div th:if="${diagnostico != null && cliente != null}">
        <!-- Header del Cliente -->
        <div class="cliente-header">
            <div class="row align-items-center">
                <div class="col-md-2 text-center">
                    <img th:src="${cliente.fotoPerfilUrl != null ? cliente.fotoPerfilUrl : '/img/fotoPerfil.png'}"
                         class="cliente-foto" alt="Foto del cliente">
                </div>
                <div class="col-md-10">
                    <h2><i class="fas fa-user-circle"></i> <span th:text="${cliente.nombre + ' ' + (cliente.apellido != null ? cliente.apellido : '')}"></span></h2>
                    <p class="mb-1"><i class="fas fa-envelope"></i> <span th:text="${cliente.email}"></span></p>
                    <p class="mb-1" th:if="${cliente.telefono != null}"><i class="fas fa-phone"></i> <span th:text="${cliente.telefono}"></span></p>
                    <p class="mb-1" th:if="${cliente.sexo != null}">
                        <i class="fas fa-venus-mars"></i>
                        <strong>G√©nero:</strong>
                        <span th:if="${cliente.sexo.toString() == 'MASCULINO'}">üë® Masculino</span>
                        <span th:if="${cliente.sexo.toString() == 'FEMENINO'}">üë© Femenino</span>
                        <span th:if="${cliente.sexo.toString() != 'MASCULINO' && cliente.sexo.toString() != 'FEMENINO'}" th:text="${cliente.sexo}"></span>
                    </p>
                    <p class="mb-0"><i class="fas fa-calendar"></i> Diagnostico del: <span th:if="${diagnostico.fecha != null}" th:text="${#temporals.format(diagnostico.fecha, 'dd/MM/yyyy')}"></span><span th:if="${diagnostico.fecha == null}">Fecha no disponible</span></p>
                </div>
            </div>
        </div>

        <!-- Objetivo del Cliente -->
        <div class="objetivo-box" th:if="${cliente.objetivo != null && !cliente.objetivo.isEmpty()}">
            <h4><i class="fas fa-bullseye"></i> Objetivo del Cliente</h4>
            <p class="mb-0" style="font-size: 1.1rem;" th:text="${cliente.objetivo}"></p>
        </div>

        <!-- Descripcion del Cliente -->
        <div class="descripcion-box" th:if="${cliente.descripcion != null && !cliente.descripcion.isEmpty()}">
            <h4><i class="fas fa-comment-dots"></i> Sobre el Cliente</h4>
            <p class="mb-0" style="font-size: 1.1rem;" th:text="${cliente.descripcion}"></p>
        </div>

        <!-- Fotos del Diagnostico -->
        <div class="categoria" th:if="${diagnostico.fotoFrontalUrl != null || diagnostico.fotoLateralUrl != null || diagnostico.fotoTraseraUrl != null}">
            <div class="categoria-titulo"><i class="fas fa-images"></i> Fotos del Diagnostico</div>
            <div class="fotos-diagnostico">
                <div class="foto-item" th:if="${diagnostico.fotoFrontalUrl != null}">
                    <img th:src="${diagnostico.fotoFrontalUrl}" alt="Foto Frontal">
                    <div class="foto-label">üì∏ Frontal</div>
                </div>
                <div class="foto-item" th:if="${diagnostico.fotoLateralUrl != null}">
                    <img th:src="${diagnostico.fotoLateralUrl}" alt="Foto Lateral">
                    <div class="foto-label">üì∏ Lateral</div>
                </div>
                <div class="foto-item" th:if="${diagnostico.fotoTraseraUrl != null}">
                    <img th:src="${diagnostico.fotoTraseraUrl}" alt="Foto Trasera">
                    <div class="foto-label">üì∏ Trasera</div>
                </div>
            </div>
        </div>

        <!-- Datos Fisicos y IMC -->
        <div class="categoria">
            <div class="categoria-titulo"><i class="fas fa-weight"></i> Datos Fisicos</div>
            <div class="row g-3">
                <div class="col-md-3">
                    <div class="info-row">
                        <div class="info-label">‚öñÔ∏è Peso</div>
                        <div class="info-value" th:text="${diagnostico.peso != null ? diagnostico.peso + ' kg' : 'No especificado'}"></div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="info-row">
                        <div class="info-label">üìè Estatura</div>
                        <div class="info-value" th:text="${diagnostico.estatura != null ? diagnostico.estatura + ' cm' : 'No especificado'}"></div>
                    </div>
                </div>
                <div class="col-md-3" th:with="imc=${diagnostico.peso != null && diagnostico.estatura != null ? T(java.lang.Math).round((diagnostico.peso / ((diagnostico.estatura/100)*(diagnostico.estatura/100))) * 10) / 10.0 : null}">
                    <div class="info-row">
                        <div class="info-label">üìä IMC</div>
                        <div class="info-value">
                            <span th:if="${imc != null}" th:text="${imc}"></span>
                            <span th:if="${imc == null}">No calculado</span>
                            <div th:if="${imc != null}">
                                <span th:if="${imc < 18.5}" class="imc-badge" style="background: #dbeafe; color: #1e40af;">Bajo peso</span>
                                <span th:if="${imc >= 18.5 && imc < 25}" class="imc-badge" style="background: #d1fae5; color: #065f46;">Peso normal</span>
                                <span th:if="${imc >= 25 && imc < 30}" class="imc-badge" style="background: #fed7aa; color: #92400e;">Sobrepeso</span>
                                <span th:if="${imc >= 30}" class="imc-badge" style="background: #fecaca; color: #991b1b;">Obesidad</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="info-row">
                        <div class="info-label">üéØ Nivel Experiencia</div>
                        <div class="info-value" th:text="${diagnostico.nivelExperiencia != null ? diagnostico.nivelExperiencia : 'No especificado'}"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Disponibilidad y Recursos -->
        <div class="categoria">
            <div class="categoria-titulo"><i class="fas fa-clock"></i> Disponibilidad y Recursos</div>
            <div class="row g-3">
                <div class="col-md-4">
                    <div class="info-row">
                        <div class="info-label">‚è∞ Disponibilidad de Tiempo</div>
                        <div class="info-value" th:text="${diagnostico.disponibilidadTiempo != null ? diagnostico.disponibilidadTiempo : 'No especificado'}"></div>
                    </div>
                </div>
                <div class="col-md-4" th:if="${diagnostico.diasDisponiblesSemana != null}">
                    <div class="info-row">
                        <div class="info-label">üìÖ Dias por Semana</div>
                        <div class="info-value" th:text="${diagnostico.diasDisponiblesSemana + ' dias'}"></div>
                    </div>
                </div>
                <div class="col-md-4" th:if="${diagnostico.horarioPreferido != null}">
                    <div class="info-row">
                        <div class="info-label">üïê Horario Preferido</div>
                        <div class="info-value" th:text="${diagnostico.horarioPreferido}"></div>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="info-row">
                        <div class="info-label">üèãÔ∏è Acceso a Recursos</div>
                        <div class="info-value" th:text="${diagnostico.accesoRecursos != null ? diagnostico.accesoRecursos : 'No especificado'}"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Salud y Condiciones -->
        <div class="categoria">
            <div class="categoria-titulo"><i class="fas fa-heartbeat"></i> Salud y Condiciones</div>
            <div class="row g-3">
                <div class="col-md-6">
                    <div class="info-row">
                        <div class="info-label">ü§ï Lesiones</div>
                        <div class="info-value" th:text="${diagnostico.lesiones != null ? diagnostico.lesiones : 'No especificado'}"></div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="info-row">
                        <div class="info-label">üè• Condiciones Medicas</div>
                        <div class="info-value" th:text="${diagnostico.condicionesMedicas != null ? diagnostico.condicionesMedicas : 'No especificado'}"></div>
                    </div>
                </div>
                <div class="col-md-12" th:if="${diagnostico.limitacionesFisicas != null && !diagnostico.limitacionesFisicas.isEmpty()}">
                    <div class="info-row">
                        <div class="info-label">‚ö†Ô∏è Limitaciones Fisicas</div>
                        <div class="info-value" th:text="${diagnostico.limitacionesFisicas}"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Habitos de Vida -->
        <div class="categoria">
            <div class="categoria-titulo"><i class="fas fa-heart"></i> Habitos de Vida</div>
            <div class="row g-3">
                <div class="col-md-4" th:if="${diagnostico.horasSueno != null}">
                    <div class="info-row">
                        <div class="info-label">üò¥ Horas de Sueno</div>
                        <div class="info-value" th:text="${diagnostico.horasSueno + ' horas'}"></div>
                    </div>
                </div>
                <div class="col-md-8">
                    <div class="info-row">
                        <div class="info-label">üçé Habitos Alimenticios</div>
                        <div class="info-value" th:text="${diagnostico.habitosAlimenticios != null ? diagnostico.habitosAlimenticios : 'No especificado'}"></div>
                    </div>
                </div>
                <div class="col-md-4" th:if="${diagnostico.nivelEstres != null}">
                    <div class="info-row">
                        <div class="info-label">üò∞ Nivel de Estres</div>
                        <div class="info-value" th:text="${diagnostico.nivelEstres}"></div>
                    </div>
                </div>
                <div class="col-md-4" th:if="${diagnostico.fumador != null}">
                    <div class="info-row">
                        <div class="info-label">üö¨ Fumador</div>
                        <div class="info-value" th:text="${diagnostico.fumador ? 'Si' : 'No'}"></div>
                    </div>
                </div>
                <div class="col-md-4" th:if="${diagnostico.consumeAlcohol != null}">
                    <div class="info-row">
                        <div class="info-label">üç∫ Consume Alcohol</div>
                        <div class="info-value">
                            <span th:text="${diagnostico.consumeAlcohol ? 'Si' : 'No'}"></span>
                            <span th:if="${diagnostico.consumeAlcohol && diagnostico.frecuenciaAlcohol != null}" th:text="${' (' + diagnostico.frecuenciaAlcohol + ')'}"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Preferencias y Motivacion -->
        <div class="categoria" th:if="${diagnostico.preferenciasEntrenamiento != null || diagnostico.motivacionPrincipal != null || diagnostico.experienciaPreviaDeportes != null}">
            <div class="categoria-titulo"><i class="fas fa-star"></i> Preferencias y Motivacion</div>
            <div class="row g-3">
                <div class="col-md-12" th:if="${diagnostico.motivacionPrincipal != null && !diagnostico.motivacionPrincipal.isEmpty()}">
                    <div class="info-row">
                        <div class="info-label">üéØ Motivacion Principal</div>
                        <div class="info-value" th:text="${diagnostico.motivacionPrincipal}"></div>
                    </div>
                </div>
                <div class="col-md-12" th:if="${diagnostico.preferenciasEntrenamiento != null && !diagnostico.preferenciasEntrenamiento.isEmpty()}">
                    <div class="info-row">
                        <div class="info-label">üí™ Preferencias de Entrenamiento</div>
                        <div class="info-value" th:text="${diagnostico.preferenciasEntrenamiento}"></div>
                    </div>
                </div>
                <div class="col-md-12" th:if="${diagnostico.experienciaPreviaDeportes != null && !diagnostico.experienciaPreviaDeportes.isEmpty()}">
                    <div class="info-row">
                        <div class="info-label">üèÜ Experiencia Previa en Deportes</div>
                        <div class="info-value" th:text="${diagnostico.experienciaPreviaDeportes}"></div>
                    </div>
                </div>
                <div class="col-md-12" th:if="${diagnostico.suplementosActuales != null && !diagnostico.suplementosActuales.isEmpty()}">
                    <div class="info-row">
                        <div class="info-label">üíä Suplementos Actuales</div>
                        <div class="info-value" th:text="${diagnostico.suplementosActuales}"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Medidas Opcionales -->
        <div class="categoria" th:if="${diagnostico.porcentajeGrasaCorporal != null || diagnostico.circunferenciaCintura != null || diagnostico.frecuenciaCardiacaReposo != null}">
            <div class="categoria-titulo"><i class="fas fa-ruler"></i> Medidas Adicionales</div>
            <div class="row g-3">
                <div class="col-md-3" th:if="${diagnostico.porcentajeGrasaCorporal != null}">
                    <div class="info-row">
                        <div class="info-label">üìä % Grasa Corporal</div>
                        <div class="info-value" th:text="${diagnostico.porcentajeGrasaCorporal + '%'}"></div>
                    </div>
                </div>
                <div class="col-md-3" th:if="${diagnostico.circunferenciaCintura != null}">
                    <div class="info-row">
                        <div class="info-label">üìè Cintura</div>
                        <div class="info-value" th:text="${diagnostico.circunferenciaCintura + ' cm'}"></div>
                    </div>
                </div>
                <div class="col-md-3" th:if="${diagnostico.circunferenciaCadera != null}">
                    <div class="info-row">
                        <div class="info-label">üìè Cadera</div>
                        <div class="info-value" th:text="${diagnostico.circunferenciaCadera + ' cm'}"></div>
                    </div>
                </div>
                <div class="col-md-3" th:if="${diagnostico.circunferenciaBrazo != null}">
                    <div class="info-row">
                        <div class="info-label">üí™ Brazo</div>
                        <div class="info-value" th:text="${diagnostico.circunferenciaBrazo + ' cm'}"></div>
                    </div>
                </div>
                <div class="col-md-3" th:if="${diagnostico.circunferenciaPierna != null}">
                    <div class="info-row">
                        <div class="info-label">ü¶µ Pierna</div>
                        <div class="info-value" th:text="${diagnostico.circunferenciaPierna + ' cm'}"></div>
                    </div>
                </div>
                <div class="col-md-3" th:if="${diagnostico.frecuenciaCardiacaReposo != null}">
                    <div class="info-row">
                        <div class="info-label">‚ù§Ô∏è FC Reposo</div>
                        <div class="info-value" th:text="${diagnostico.frecuenciaCardiacaReposo + ' bpm'}"></div>
                    </div>
                </div>
                <div class="col-md-3" th:if="${diagnostico.presionArterial != null}">
                    <div class="info-row">
                        <div class="info-label">ü©∫ Presion Arterial</div>
                        <div class="info-value" th:text="${diagnostico.presionArterial}"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-4">
        <a href="/entrenador/suscripciones" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Volver
        </a>
    </div>
</div>
</section>
</body>
</html>

